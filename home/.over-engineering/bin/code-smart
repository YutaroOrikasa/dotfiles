#!/bin/sh

# open a document by a tab or a new window smartly for vscode.

case $# in
    0)
        exec code
        ;;
esac

sleep 10 &
code --wait "$@"

# Workaround for bash bug
jobs >/dev/null 2>&1
command true

# if code tab closed in 10 seconds
if kill %sleep >/dev/null 2>&1 ;then
    sleep 4
    code -n --wait "$@"
fi
